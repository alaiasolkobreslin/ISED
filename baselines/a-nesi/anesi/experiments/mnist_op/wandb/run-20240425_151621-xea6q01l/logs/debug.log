2024-04-25 15:16:21,641 INFO    MainThread:3321547 [wandb_setup.py:_flush():68] Configure stats pid to 3321547
2024-04-25 15:16:21,641 INFO    MainThread:3321547 [wandb_setup.py:_flush():68] Loading settings from /root/.config/wandb/settings
2024-04-25 15:16:21,641 INFO    MainThread:3321547 [wandb_setup.py:_flush():68] Loading settings from /workspace/neuro-symbolic-dataset/baselines/a-nesi/anesi/experiments/mnist_op/wandb/settings
2024-04-25 15:16:21,641 WARNING MainThread:3321547 [wandb_setup.py:_flush():68] Unknown environment variable: WANDB_SERVICE
2024-04-25 15:16:21,642 INFO    MainThread:3321547 [wandb_setup.py:_flush():68] Loading settings from environment variables: {'_require_service': 'True', 'entity': 'blackbox-learning', 'project': 'mnist-add', 'sweep_id': 'xwkgjzpf', 'root_dir': '/workspace/neuro-symbolic-dataset/baselines/a-nesi/anesi/experiments/mnist_op', 'run_id': 'xea6q01l', 'sweep_param_path': '/workspace/neuro-symbolic-dataset/baselines/a-nesi/anesi/experiments/mnist_op/wandb/sweep-xwkgjzpf/config-xea6q01l.yaml'}
2024-04-25 15:16:21,642 INFO    MainThread:3321547 [wandb_setup.py:_flush():68] Inferring run settings from compute environment: {'program_relpath': 'baselines/a-nesi/anesi/experiments/mnist_op/mnistop.py', 'program': '/workspace/neuro-symbolic-dataset/baselines/a-nesi/anesi/experiments/mnist_op/mnistop.py'}
2024-04-25 15:16:21,642 INFO    MainThread:3321547 [wandb_init.py:_log_setup():476] Logging user logs to /workspace/neuro-symbolic-dataset/baselines/a-nesi/anesi/experiments/mnist_op/wandb/run-20240425_151621-xea6q01l/logs/debug.log
2024-04-25 15:16:21,642 INFO    MainThread:3321547 [wandb_init.py:_log_setup():477] Logging internal logs to /workspace/neuro-symbolic-dataset/baselines/a-nesi/anesi/experiments/mnist_op/wandb/run-20240425_151621-xea6q01l/logs/debug-internal.log
2024-04-25 15:16:21,643 INFO    MainThread:3321547 [wandb_init.py:init():516] calling init triggers
2024-04-25 15:16:21,643 INFO    MainThread:3321547 [wandb_init.py:init():519] wandb.init called with sweep_config: {'K_beliefs': 2500, 'N': 1, 'amt_samples': 600, 'batch_size': 16, 'dirichlet_L2': 900000, 'dirichlet_init': 0.1, 'dirichlet_iters': 50, 'dirichlet_lr': 0.01, 'epochs': 10, 'hidden_size': 800, 'layers': 3, 'nrm_loss': 'mse', 'nrm_lr': 0.001, 'percept_loss_pref': 1, 'perception_loss': 'log-q', 'perception_lr': 0.001, 'policy': 'off', 'predict_only': True, 'prune': False, 'runs': 1, 'test': True, 'use_prior': True}
config: {'program': 'mnistop.py', 'project': 'mnist-add', 'entity': 'nesy-gems', 'method': 'random', 'metric': {'name': 'val_accuracy', 'goal': 'maximize'}, 'early_terminate': {'type': 'hyperband', 'min_iter': 4}, 'parameters': {'N': {'values': [1]}, 'epochs': {'values': [30]}, 'batch_size': {'values': [16, 64, 256, 1024]}, 'amt_samples': {'values': [16, 64, 256, 1024]}, 'K_beliefs': {'values': [100, 1000, 10000]}, 'nrm_lr': {'distribution': 'log_uniform_values', 'min': '1e-4', 'max': '1e-1'}, 'perception_lr': {'distribution': 'log_uniform_values', 'min': '1e-4', 'max': '1e-1'}, 'dirichlet_lr': {'distribution': 'log_uniform_values', 'min': '1e-3', 'max': 1}, 'dirichlet_iters': {'distribution': 'q_log_uniform_values', 'min': 1, 'max': 100}, 'dirichlet_init': {'distribution': 'log_uniform_values', 'min': '1e-1', 'max': 10}, 'nrm_loss': {'values': ['mse', 'bce']}, 'perception_loss': {'values': ['log-q', 'sampled']}, 'prune': {'values': [True]}, 'policy': {'values': ['on', 'both']}, 'hidden_size': {'distribution': 'q_log_uniform_values', 'min': 20, 'max': 2000}}}
2024-04-25 15:16:21,643 INFO    MainThread:3321547 [wandb_init.py:init():569] starting backend
2024-04-25 15:16:21,643 INFO    MainThread:3321547 [wandb_init.py:init():573] setting up manager
2024-04-25 15:16:21,649 INFO    MainThread:3321547 [backend.py:_multiprocessing_setup():102] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-04-25 15:16:21,653 INFO    MainThread:3321547 [wandb_init.py:init():580] backend started and connected
2024-04-25 15:16:21,659 INFO    MainThread:3321547 [wandb_run.py:_config_callback():1160] config_cb None None {'K_beliefs': 2500, 'N': 1, 'amt_samples': 600, 'batch_size': 16, 'dirichlet_L2': 900000, 'dirichlet_init': 0.1, 'dirichlet_iters': 50, 'dirichlet_lr': 0.01, 'epochs': 10, 'hidden_size': 800, 'layers': 3, 'nrm_loss': 'mse', 'nrm_lr': 0.001, 'percept_loss_pref': 1, 'perception_loss': 'log-q', 'perception_lr': 0.001, 'policy': 'off', 'predict_only': True, 'prune': False, 'runs': 1, 'test': True, 'use_prior': True}
2024-04-25 15:16:21,664 INFO    MainThread:3321547 [wandb_init.py:init():658] updated telemetry
2024-04-25 15:16:21,692 INFO    MainThread:3321547 [wandb_init.py:init():693] communicating run to backend with 60 second timeout
2024-04-25 15:16:22,046 INFO    MainThread:3321547 [wandb_run.py:_on_init():2000] communicating current version
2024-04-25 15:16:22,166 INFO    MainThread:3321547 [wandb_run.py:_on_init():2004] got version response upgrade_message: "wandb version 0.16.6 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-04-25 15:16:22,166 INFO    MainThread:3321547 [wandb_init.py:init():728] starting run threads in backend
2024-04-25 15:16:24,688 INFO    MainThread:3321547 [wandb_run.py:_console_start():1980] atexit reg
2024-04-25 15:16:24,689 INFO    MainThread:3321547 [wandb_run.py:_redirect():1838] redirect: SettingsConsole.WRAP_RAW
2024-04-25 15:16:24,689 INFO    MainThread:3321547 [wandb_run.py:_redirect():1903] Wrapping output streams.
2024-04-25 15:16:24,689 INFO    MainThread:3321547 [wandb_run.py:_redirect():1925] Redirects installed.
2024-04-25 15:16:24,689 INFO    MainThread:3321547 [wandb_init.py:init():765] run started, returning control to user process
